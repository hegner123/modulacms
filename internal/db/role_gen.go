// Code generated by tools/dbgen; DO NOT EDIT.
package db

import (
	"fmt"

	mdbm "github.com/hegner123/modulacms/internal/db-mysql"
	mdbp "github.com/hegner123/modulacms/internal/db-psql"
	mdb "github.com/hegner123/modulacms/internal/db-sqlite"
	"github.com/hegner123/modulacms/internal/db/types"
)

///////////////////////////////
// STRUCTS
//////////////////////////////

// Roles represents a role record in the database.
type Roles struct {
	RoleID          types.RoleID `json:"role_id"`
	Label           string       `json:"label"`
	SystemProtected bool         `json:"system_protected"`
}

// CreateRoleParams contains parameters for creating a new role.
type CreateRoleParams struct {
	Label           string `json:"label"`
	SystemProtected bool   `json:"system_protected"`
}

// UpdateRoleParams contains parameters for updating an existing role.
type UpdateRoleParams struct {
	Label           string       `json:"label"`
	SystemProtected bool         `json:"system_protected"`
	RoleID          types.RoleID `json:"role_id"`
}

// MapStringRole converts Roles to StringRoles for TUI display.
func MapStringRole(a Roles) StringRoles {
	return StringRoles{
		RoleID: a.RoleID.String(),
		Label:  a.Label,
	}
}

///////////////////////////////
// SQLITE
//////////////////////////////

// QUERIES

// CountRoles returns the total number of roles in the database.
func (d Database) CountRoles() (*int64, error) {
	queries := mdb.New(d.Connection)
	c, err := queries.CountRole(d.Context)
	if err != nil {
		return nil, fmt.Errorf("%v", err)
	}
	return &c, nil
}

// CreateRoleTable creates the roles table in the database.
func (d Database) CreateRoleTable() error {
	queries := mdb.New(d.Connection)
	err := queries.CreateRoleTable(d.Context)
	return err
}

// GetRole retrieves a role by ID.
func (d Database) GetRole(id types.RoleID) (*Roles, error) {
	queries := mdb.New(d.Connection)
	row, err := queries.GetRole(d.Context, mdb.GetRoleParams{RoleID: id})
	if err != nil {
		return nil, err
	}
	res := d.MapRole(row)
	return &res, nil
}

// ListRoles retrieves all roles in the database.
func (d Database) ListRoles() (*[]Roles, error) {
	queries := mdb.New(d.Connection)
	rows, err := queries.ListRole(d.Context)
	if err != nil {
		return nil, fmt.Errorf("failed to get Roles: %v\n", err)
	}
	res := []Roles{}
	for _, v := range rows {
		m := d.MapRole(v)
		res = append(res, m)
	}
	return &res, nil
}

///////////////////////////////
// MYSQL
//////////////////////////////

// QUERIES

// CountRoles returns the total number of roles in the database.
func (d MysqlDatabase) CountRoles() (*int64, error) {
	queries := mdbm.New(d.Connection)
	c, err := queries.CountRole(d.Context)
	if err != nil {
		return nil, fmt.Errorf("%v", err)
	}
	return &c, nil
}

// CreateRoleTable creates the roles table in the database.
func (d MysqlDatabase) CreateRoleTable() error {
	queries := mdbm.New(d.Connection)
	err := queries.CreateRoleTable(d.Context)
	return err
}

// GetRole retrieves a role by ID.
func (d MysqlDatabase) GetRole(id types.RoleID) (*Roles, error) {
	queries := mdbm.New(d.Connection)
	row, err := queries.GetRole(d.Context, mdbm.GetRoleParams{RoleID: id})
	if err != nil {
		return nil, err
	}
	res := d.MapRole(row)
	return &res, nil
}

// ListRoles retrieves all roles in the database.
func (d MysqlDatabase) ListRoles() (*[]Roles, error) {
	queries := mdbm.New(d.Connection)
	rows, err := queries.ListRole(d.Context)
	if err != nil {
		return nil, fmt.Errorf("failed to get Roles: %v\n", err)
	}
	res := []Roles{}
	for _, v := range rows {
		m := d.MapRole(v)
		res = append(res, m)
	}
	return &res, nil
}

///////////////////////////////
// POSTGRES
//////////////////////////////

// QUERIES

// CountRoles returns the total number of roles in the database.
func (d PsqlDatabase) CountRoles() (*int64, error) {
	queries := mdbp.New(d.Connection)
	c, err := queries.CountRole(d.Context)
	if err != nil {
		return nil, fmt.Errorf("%v", err)
	}
	return &c, nil
}

// CreateRoleTable creates the roles table in the database.
func (d PsqlDatabase) CreateRoleTable() error {
	queries := mdbp.New(d.Connection)
	err := queries.CreateRoleTable(d.Context)
	return err
}

// GetRole retrieves a role by ID.
func (d PsqlDatabase) GetRole(id types.RoleID) (*Roles, error) {
	queries := mdbp.New(d.Connection)
	row, err := queries.GetRole(d.Context, mdbp.GetRoleParams{RoleID: id})
	if err != nil {
		return nil, err
	}
	res := d.MapRole(row)
	return &res, nil
}

// ListRoles retrieves all roles in the database.
func (d PsqlDatabase) ListRoles() (*[]Roles, error) {
	queries := mdbp.New(d.Connection)
	rows, err := queries.ListRole(d.Context)
	if err != nil {
		return nil, fmt.Errorf("failed to get Roles: %v\n", err)
	}
	res := []Roles{}
	for _, v := range rows {
		m := d.MapRole(v)
		res = append(res, m)
	}
	return &res, nil
}
