// Code generated by tools/dbgen; DO NOT EDIT.
package db

import (
	"fmt"

	mdbm "github.com/hegner123/modulacms/internal/db-mysql"
	mdbp "github.com/hegner123/modulacms/internal/db-psql"
	mdb "github.com/hegner123/modulacms/internal/db-sqlite"
	"github.com/hegner123/modulacms/internal/db/types"
)

///////////////////////////////
// STRUCTS
//////////////////////////////

// Routes represents a route record in the database.
type Routes struct {
	RouteID      types.RouteID        `json:"route_id"`
	Slug         types.Slug           `json:"slug"`
	Title        string               `json:"title"`
	Status       int64                `json:"status"`
	AuthorID     types.NullableUserID `json:"author_id"`
	DateCreated  types.Timestamp      `json:"date_created"`
	DateModified types.Timestamp      `json:"date_modified"`
}

// CreateRouteParams contains parameters for creating a new route.
type CreateRouteParams struct {
	Slug         types.Slug           `json:"slug"`
	Title        string               `json:"title"`
	Status       int64                `json:"status"`
	AuthorID     types.NullableUserID `json:"author_id"`
	DateCreated  types.Timestamp      `json:"date_created"`
	DateModified types.Timestamp      `json:"date_modified"`
}

// UpdateRouteParams contains parameters for updating an existing route.
type UpdateRouteParams struct {
	Slug         types.Slug           `json:"slug"`
	Title        string               `json:"title"`
	Status       int64                `json:"status"`
	AuthorID     types.NullableUserID `json:"author_id"`
	DateCreated  types.Timestamp      `json:"date_created"`
	DateModified types.Timestamp      `json:"date_modified"`
	Slug_2       types.Slug           `json:"slug_2"`
}

// MapStringRoute converts Routes to StringRoutes for TUI display.
func MapStringRoute(a Routes) StringRoutes {
	return StringRoutes{
		RouteID:      a.RouteID.String(),
		Slug:         string(a.Slug),
		Title:        a.Title,
		Status:       fmt.Sprintf("%d", a.Status),
		AuthorID:     a.AuthorID.String(),
		DateCreated:  a.DateCreated.String(),
		DateModified: a.DateModified.String(),
		History:      "",
	}
}

///////////////////////////////
// SQLITE
//////////////////////////////

// QUERIES

// CountRoutes returns the total number of routes in the database.
func (d Database) CountRoutes() (*int64, error) {
	queries := mdb.New(d.Connection)
	c, err := queries.CountRoute(d.Context)
	if err != nil {
		return nil, fmt.Errorf("%v", err)
	}
	return &c, nil
}

// CreateRouteTable creates the routes table in the database.
func (d Database) CreateRouteTable() error {
	queries := mdb.New(d.Connection)
	err := queries.CreateRouteTable(d.Context)
	return err
}

// GetRoute retrieves a route by ID.
func (d Database) GetRoute(id types.RouteID) (*Routes, error) {
	queries := mdb.New(d.Connection)
	row, err := queries.GetRoute(d.Context, mdb.GetRouteParams{RouteID: id})
	if err != nil {
		return nil, err
	}
	res := d.MapRoute(row)
	return &res, nil
}

// ListRoutes retrieves all routes in the database.
func (d Database) ListRoutes() (*[]Routes, error) {
	queries := mdb.New(d.Connection)
	rows, err := queries.ListRoute(d.Context)
	if err != nil {
		return nil, fmt.Errorf("failed to get Routes: %v\n", err)
	}
	res := []Routes{}
	for _, v := range rows {
		m := d.MapRoute(v)
		res = append(res, m)
	}
	return &res, nil
}

///////////////////////////////
// MYSQL
//////////////////////////////

// QUERIES

// CountRoutes returns the total number of routes in the database.
func (d MysqlDatabase) CountRoutes() (*int64, error) {
	queries := mdbm.New(d.Connection)
	c, err := queries.CountRoute(d.Context)
	if err != nil {
		return nil, fmt.Errorf("%v", err)
	}
	return &c, nil
}

// CreateRouteTable creates the routes table in the database.
func (d MysqlDatabase) CreateRouteTable() error {
	queries := mdbm.New(d.Connection)
	err := queries.CreateRouteTable(d.Context)
	return err
}

// GetRoute retrieves a route by ID.
func (d MysqlDatabase) GetRoute(id types.RouteID) (*Routes, error) {
	queries := mdbm.New(d.Connection)
	row, err := queries.GetRoute(d.Context, mdbm.GetRouteParams{RouteID: id})
	if err != nil {
		return nil, err
	}
	res := d.MapRoute(row)
	return &res, nil
}

// ListRoutes retrieves all routes in the database.
func (d MysqlDatabase) ListRoutes() (*[]Routes, error) {
	queries := mdbm.New(d.Connection)
	rows, err := queries.ListRoute(d.Context)
	if err != nil {
		return nil, fmt.Errorf("failed to get Routes: %v\n", err)
	}
	res := []Routes{}
	for _, v := range rows {
		m := d.MapRoute(v)
		res = append(res, m)
	}
	return &res, nil
}

///////////////////////////////
// POSTGRES
//////////////////////////////

// QUERIES

// CountRoutes returns the total number of routes in the database.
func (d PsqlDatabase) CountRoutes() (*int64, error) {
	queries := mdbp.New(d.Connection)
	c, err := queries.CountRoute(d.Context)
	if err != nil {
		return nil, fmt.Errorf("%v", err)
	}
	return &c, nil
}

// CreateRouteTable creates the routes table in the database.
func (d PsqlDatabase) CreateRouteTable() error {
	queries := mdbp.New(d.Connection)
	err := queries.CreateRouteTable(d.Context)
	return err
}

// GetRoute retrieves a route by ID.
func (d PsqlDatabase) GetRoute(id types.RouteID) (*Routes, error) {
	queries := mdbp.New(d.Connection)
	row, err := queries.GetRoute(d.Context, mdbp.GetRouteParams{RouteID: id})
	if err != nil {
		return nil, err
	}
	res := d.MapRoute(row)
	return &res, nil
}

// ListRoutes retrieves all routes in the database.
func (d PsqlDatabase) ListRoutes() (*[]Routes, error) {
	queries := mdbp.New(d.Connection)
	rows, err := queries.ListRoute(d.Context)
	if err != nil {
		return nil, fmt.Errorf("failed to get Routes: %v\n", err)
	}
	res := []Routes{}
	for _, v := range rows {
		m := d.MapRoute(v)
		res = append(res, m)
	}
	return &res, nil
}
